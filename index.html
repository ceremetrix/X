<!DOCTYPE html>
<html>
<head>
    <title>XTK TEST WITHOUT COMPILATION</title>
    <link rel="stylesheet" type="text/css" href="/../css/main.css" />
    <script type="text/javascript" src="lib/google-closure-library/closure/goog/base.js"></script>
    <script type="text/javascript" src="xtk-deps.js"></script>

    <script type="text/javascript">

        // include all used X-classes here
        // this is only required when using the xtk-deps.js file
        goog.require('X.renderer');
        goog.require('X.renderer3D');
        goog.require('X.renderer2D');
        goog.require('X.volume');
        goog.require('X.slice');
        goog.require('X.mesh');
        goog.require('X.labelmap');

        window.onload = function () {

            // create and initialize a 3D renderer
            var r = new X.renderer3D();
            r.container = '3d';
            r.init();

            // create the 2D renderers
            // .. for the X orientation
            var sliceX = new X.renderer2D();
            sliceX.container = 'sag';
            sliceX.orientation = 'X';
            //sliceX.bgcolor = [255,255,255];
            sliceX.init();
            // .. for Y
            var sliceY = new X.renderer2D();
            sliceY.container = 'cor';
            sliceY.orientation = 'Y';
            sliceY.init();
            // .. and for Z
            var sliceZ = new X.renderer2D();
            sliceZ.container = 'ax';
            sliceZ.orientation = 'Z';
            sliceZ.init();

            // create a volume
            var volume = new X.volume();
            volume.file = "/../Images/Patient01_zScores.nii";
            
            //volume.file = "/../Images/MRI_Template.nii"; // MRI file
            volume.labelmap.file = "/../Images/Patient01_clusterIDs.nii";
            //volume.labelmap.file = "/../Images/Patient01.norm.nii";
            //volume.labelmap.colortable.file = "/../Images/MRI_colorTable.txt";
            volume.labelmap.colortable.file  = "/../Images/colortable_copy.txt";
            //volume.labelmap.opacity = 0.6;
            volume.opacity = 0.3;
  
            //var volume2 = new X.volume();
            //volume2.file = "/../Images/Patient01.norm.nii"
            //volume2.opacity = 0.3; 

            var mesh = new X.mesh();
            mesh.file = "/../Images/clusters.vtk";
            mesh.color = [0.7, 0.25, 0.25];
            mesh.opacity = 1;

            var mesh2 = new X.mesh();
            mesh2.file = "/../Images/clusters_NEW.vtk";
            mesh2.color = [1, 0.4, 0.7];
            mesh2.opacity = 1;

            // Windowing doesn't seem to do much yet, but 
            // thresholding does! LL 1.27.17
            
            //volume.lowerThreshold = 15;

            //alert(volume.color[1000,10,0]);
            //volume.maxColor = [1, .4, .1];
            //volume.minColor = [0, 0, .5];
            
            // add the volume in the main renderer
            // we choose the sliceX here, since this should work also on
            // non-webGL-friendly devices like Safari on iOS
            sliceX.add(volume);
            //sliceX.add(volume2);
            //sliceX.setColortable(0);
            // start the loading/rendering
            sliceX.render();

            sliceX.onShowtime = function () {

                sliceY.add(volume);
                //sliceY.add(volume2);
                sliceY.render();
                sliceZ.add(volume);
                //sliceZ.add(volume2);
                sliceZ.render();

                r.add(volume);
                
                r.setColortable(0);
                //r.setLabelmapColortable(1);
                //r.add(mesh);
                //r.add(mesh2);
                
                //r.setColortable(2);
                r.render();
                //volume.lowerThreshold = 1;
                //volume.opacity = 0.1;
                //volume.volumeRendering = true;
                
                //volume.volumeRendering = true;
                //volume.opacity = 0.1;    
                
                //volume.minColor = [1,0,0];
                //volume.maxColor = [0,0,1];
                
            }

            // adjust the camera position a little bit, just for visualization purposes
            r.camera.position = [0, 0, 200];
            
        };
    </script>

</head>
<body>
    <!--3D slice rendering-->
    <div id='3d' class='threeDRenderer' style="background-color: #000; width: 100%; height: 70%; margin-bottom: 2px;"></div>
    <!--2D slice viewers-->

    <div id="sag"
            style="border-top: 2px solid red; background-color: #000; width: 32%; height: 30%; float: left;"></div>
    <div id="cor"
            style="border-top: 2px solid limegreen;background-color: #000; width: 32%; height: 30%; float: left;"></div>
    <div id="ax"
            style="border-top: 2px solid blue; background-color: #000; width: 32%; height: 30%; float: left;"></div>

    <!--/2D slice viewers-->
</body>


</html>